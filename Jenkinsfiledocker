pipeline {
   agent any
   stages{
     stage('build'){
       steps{
         sh 'mvn clean package'
     stage ('Docker') {
            def registryIp = "registry.progressoft.com"
            repository = "${registryIp}/tomcatwebapp:${env.BUILD_ID}"

            sh "docker login -u developer -p developer ${registryIp}"
            sh "docker build . -t tomcatwebapp:${env.BUILD_ID}"
            sh "docker push tomcatwebapp:${env.BUILD_ID}"
            sh "docker login -u developer -p developer registry.progressoft.com"
         
         
        }

      }
    }
  }
}
